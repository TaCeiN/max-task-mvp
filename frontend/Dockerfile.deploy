# Dockerfile –¥–ª—è –¥–µ–ø–ª–æ—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –Ω–∞ GitHub Pages (–≤–∞—Ä–∏–∞–Ω—Ç 1)
FROM node:20-alpine

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º git –∏ –¥—Ä—É–≥–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
RUN apk add --no-cache git openssh

WORKDIR /app

# –ö–æ–ø–∏—Ä—É–µ–º package —Ñ–∞–π–ª—ã
COPY package*.json ./

# –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
RUN npm ci

# –ö–æ–ø–∏—Ä—É–µ–º –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
COPY . .

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ–∞–π–ª—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
RUN echo "üìã Checking utils files..." && \
    if [ -f src/utils/faq.ts ]; then \
      echo "‚úÖ faq.ts found in utils"; \
      ls -lh src/utils/faq.ts; \
    else \
      echo "‚ùå faq.ts NOT found in utils"; \
      echo "Contents of src/utils/:"; \
      ls -la src/utils/ 2>/dev/null || echo "‚ö†Ô∏è  utils directory not found"; \
    fi

# –î–µ–ª–∞–µ–º deploy.sh –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
RUN chmod +x /app/deploy.sh

# –ê—Ä–≥—É–º–µ–Ω—Ç—ã –¥–ª—è –¥–µ–ø–ª–æ—è (–ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ø—Ä–∏ —Å–±–æ—Ä–∫–µ)
ARG VITE_API_URL
ARG GITHUB_REPO=tacein/tacein.github.io
ARG GITHUB_USER=tacein
ARG GITHUB_EMAIL

# –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–±—É–¥—É—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —á–µ—Ä–µ–∑ environment –≤ docker-compose)
ENV VITE_API_URL=${VITE_API_URL}
ENV GITHUB_REPO=${GITHUB_REPO}
ENV GITHUB_USER=${GITHUB_USER}
ENV GITHUB_EMAIL=${GITHUB_EMAIL}
# GITHUB_TOKEN –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ environment, –Ω–µ —á–µ—Ä–µ–∑ ARG (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

# –ó–∞–ø—É—Å–∫–∞–µ–º –¥–µ–ø–ª–æ–π (GITHUB_TOKEN –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–Ω —á–µ—Ä–µ–∑ environment)
CMD ["/app/deploy.sh"]

